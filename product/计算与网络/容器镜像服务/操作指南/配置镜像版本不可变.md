## 操作场景
腾讯云容器镜像服务（Tencent Container Registry, TCR）企业版支持对托管的容器镜像版本进行保护。容器镜像安全是云原生应用交付中的关键一环，对托管在TCR的镜像开启版本不可变功能，可确保相同版本的镜像仅被成功推送一次，进而有效降低生产环境下由误操作引起的的版本覆盖风险。

镜像版本不可变功能内置在镜像仓库中，用户可前往【版本管理】菜单下创建【版本不可变规则】。TCR支持命名空间级别的版本保护，用户可以根据业务需求细粒度的定义该功能所覆盖的仓库和镜像版本。

## 前提条件
在使用镜像版本不可变功能前，您需要完成以下准备工作：
- 已成功 [购买企业版实例](https://cloud.tencent.com/document/product/1141/51110)。
- 如果使用子账号进行操作，[企业版授权方案示例](https://cloud.tencent.com/document/product/1141/41417)提前为子账号授予对应实例的操作权限。

## 操作步骤

### 创建版本不可变规则

1. 登陆 [容器镜像服务](https://console.cloud.tencent.com/tcr) 控制台，选择左侧导航栏中的【版本管理】> 【版本不可变】
2. 在 “版本不可变” 页面，如果需要切换实例，请在页面上方选择实例所在地域，并在【实例名称】下拉列表中进行选择。
3. 点击【新建规则】，在“新建版本不可变规则”窗口中，参考以下提示进行规则配置。如下图所示：
![](https://main.qcloudimg.com/raw/b8f3c3ae13402c7cb40d1e2088adc65d.png)
 - **所属实例**：当前已选择实例。
 - **命名空间**：当前实例需要开启版本保护的命名空间，单个命名空间内仅支持创建一条规则。
 - **不可变规则**：
    - **latest**：当前命名空间下所有仓库中，除latest版本外，其余镜像版本均不可被覆盖。
    - **自定义**：自定义配置需要匹配的仓库和镜像版本。
      - **仓库匹配**：下拉列表选择镜像仓库的过滤类型【匹配】或【排除】，在文本框中根据正则指引填写需要过滤的仓库名称。
      - **版本匹配**：下拉列表选择镜像版本的过滤类型【匹配】或【排除】，在文本框中根据正则指引填写需要过滤的版本名称。
 - **启用规则**：规则默认创建时生效。
4. 点击【确定】，完成新建。

### 管理版本不可变规则
1. 成功创建后即可在“版本不可变”页面查看规则，您可执行以下操作管理版本不可变规则。如下图所示：
![](https://main.qcloudimg.com/raw/a3efc5b03c30b5b18bda32e99cb12c74.png)
2. 配置：重新配置实例版本不可变规则，不支持修改生效的命名空间。
3. 删除：删除该实例下的版本不可变规则。
	> ! 规则状态启用即代表规则生效，您可在配置中开启/关闭该规则。
